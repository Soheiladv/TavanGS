{% extends 'base/base.html' %}
{% load i18n %}

{% block title %}داشبورد مدیریت سایت{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-10 relative z-10">
    <h1 class="text-3xl font-bold text-gray-900 mb-8">داشبورد مدیریت سایت</h1>

    <!-- Quick Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
        <a href="{% url 'settings_app:fonts_list' %}" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition">
            <div class="flex items-center mb-4">
                <i class="fas fa-font text-2xl text-primary mr-3"></i>
                <h2 class="text-lg font-semibold">مدیریت فونت</h2>
            </div>
            <p class="text-gray-600 text-sm">فونت‌ها: {{ fonts_count|default:"0" }}</p>
        </a>
        <a href="{% url 'settings_app:control_templates' %}" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition">
            <div class="flex items-center mb-4">
                <i class="fas fa-layer-group text-2xl text-secondary mr-3"></i>
                <h2 class="text-lg font-semibold">مدیریت تمپلیت</h2>
            </div>
            <p class="text-gray-600 text-sm">قالب فعال: {{ settings.get_template_theme_display|default:"پیش‌فرض" }}</p>
        </a>
        <a href="{% url 'settings_app:control_features' %}" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition">
            <div class="flex items-center mb-4">
                <i class="fas fa-toggle-on text-2xl text-accent mr-3"></i>
                <h2 class="text-lg font-semibold">مدیریت فیچرها</h2>
            </div>
            <p class="text-gray-600 text-sm">آخرین تغییرات فیچر</p>
        </a>
        <a href="{% url 'settings_app:control_users' %}" class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition">
            <div class="flex items-center mb-4">
                <i class="fas fa-users-cog text-2xl text-primary mr-3"></i>
                <h2 class="text-lg font-semibold">مدیریت کاربران</h2>
            </div>
            <p class="text-gray-600 text-sm">کاربران: {{ users_count|default:"0" }} | کارکنان: {{ staff_count|default:"0" }}</p>
        </a>
    </div>

    <!-- Accordion Management Panel -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        <div class="p-6 border-b">
            <h2 class="text-2xl font-bold text-gray-900">پنل مدیریت کامل سیستم</h2>
            <p class="text-gray-600 mt-2">دسترسی به تمام بخش‌های مدیریتی سیستم</p>
        </div>

        <!-- Accordion Container -->
        <div class="accordion space-y-2" id="managementAccordion">
            
            <!-- 🛍️ Products Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="productsHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 role="button" type="button" data-target="#productsCollapse" aria-expanded="true" aria-controls="productsCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-box text-2xl text-blue-600 mr-3"></i>
                            <span>مدیریت محصولات</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="productsChevron"></i>
                    </button>
                </h3>
                <div id="productsCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="productsHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'products:list' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-list text-blue-600 mr-3"></i>
                                <span>فهرست محصولات</span>
                            </a>
                            <a href="{% url 'products:create' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-plus text-green-600 mr-3"></i>
                                <span>ایجاد محصول جدید</span>
                            </a>
                            <a href="{% url 'products:category_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-tags text-purple-600 mr-3"></i>
                                <span>دسته‌بندی محصولات</span>
                            </a>
                            <a href="{% url 'products:category_create' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-folder-plus text-orange-600 mr-3"></i>
                                <span>ایجاد دسته جدید</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 🛠️ Services Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="servicesHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-green-500 role="button" type="button" data-target="#servicesCollapse" aria-expanded="false" aria-controls="servicesCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-cogs text-2xl text-green-600 mr-3"></i>
                            <span>مدیریت خدمات</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="servicesChevron"></i>
                    </button>
                </h3>
                <div id="servicesCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="servicesHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'services:list' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-list text-green-600 mr-3"></i>
                                <span>فهرست خدمات</span>
                            </a>
                            <a href="{% url 'services:create' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-plus text-blue-600 mr-3"></i>
                                <span>ایجاد سرویس جدید</span>
                            </a>
                            <a href="{% url 'services:category_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-tags text-purple-600 mr-3"></i>
                                <span>دسته‌بندی خدمات</span>
                            </a>
                            <a href="{% url 'services:category_create' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-folder-plus text-orange-600 mr-3"></i>
                                <span>ایجاد دسته سرویس</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 💰 Sales Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="salesHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-yellow-500 role="button" type="button" data-target="#salesCollapse" aria-expanded="false" aria-controls="salesCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-chart-line text-2xl text-yellow-600 mr-3"></i>
                            <span>مدیریت فروش</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="salesChevron"></i>
                    </button>
                </h3>
                <div id="salesCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="salesHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'sales:dashboard' %}" class="flex items-center p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition">
                                <i class="fas fa-tachometer-alt text-yellow-600 mr-3"></i>
                                <span>داشبورد فروش</span>
                            </a>
                            <a href="{% url 'sales:version_list' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-code-branch text-blue-600 mr-3"></i>
                                <span>نسخه‌های محصولات</span>
                            </a>
                            <a href="{% url 'sales:version_create' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-plus text-green-600 mr-3"></i>
                                <span>ایجاد نسخه جدید</span>
                            </a>
                            <a href="{% url 'sales:demo_request_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-play text-purple-600 mr-3"></i>
                                <span>درخواست‌های دمو</span>
                            </a>
                            <a href="{% url 'sales:pricing_request_list' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-dollar-sign text-orange-600 mr-3"></i>
                                <span>درخواست‌های قیمت</span>
                            </a>
                            <a href="{% url 'sales:sales_lead_list' %}" class="flex items-center p-3 bg-red-50 hover:bg-red-100 rounded-lg transition">
                                <i class="fas fa-user-tie text-red-600 mr-3"></i>
                                <span>سرنخ‌های فروش</span>
                            </a>
                            <a href="{% url 'sales:sales_lead_create' %}" class="flex items-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition">
                                <i class="fas fa-user-plus text-indigo-600 mr-3"></i>
                                <span>ایجاد سرنخ جدید</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 🎫 Tickets Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="ticketsHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-red-500 role="button" type="button" data-target="#ticketsCollapse" aria-expanded="false" aria-controls="ticketsCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-life-ring text-2xl text-red-600 mr-3"></i>
                            <span>مدیریت تیکت‌ها</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="ticketsChevron"></i>
                    </button>
                </h3>
                <div id="ticketsCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="ticketsHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'tickets:dashboard' %}" class="flex items-center p-3 bg-red-50 hover:bg-red-100 rounded-lg transition">
                                <i class="fas fa-tachometer-alt text-red-600 mr-3"></i>
                                <span>داشبورد تیکت‌ها</span>
                            </a>
                            <a href="{% url 'tickets:create' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-plus text-green-600 mr-3"></i>
                                <span>ایجاد تیکت جدید</span>
                            </a>
                            <a href="{% url 'tickets:category_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-tags text-purple-600 mr-3"></i>
                                <span>دسته‌بندی تیکت‌ها</span>
                            </a>
                            <a href="{% url 'tickets:category_create' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-folder-plus text-orange-600 mr-3"></i>
                                <span>ایجاد دسته تیکت</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ⚙️ Settings Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="settingsHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-500 role="button" type="button" data-target="#settingsCollapse" aria-expanded="false" aria-controls="settingsCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-cog text-2xl text-gray-600 mr-3"></i>
                            <span>تنظیمات سیستم</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="settingsChevron"></i>
                    </button>
                </h3>
                <div id="settingsCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="settingsHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'settings_app:fonts_list' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-font text-blue-600 mr-3"></i>
                                <span>مدیریت فونت‌ها</span>
                            </a>
                            <a href="{% url 'settings_app:fonts_create' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-plus text-green-600 mr-3"></i>
                                <span>ایجاد فونت جدید</span>
                            </a>
                            <a href="{% url 'settings_app:template_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-layer-group text-purple-600 mr-3"></i>
                                <span>تمپلیت‌های سایت</span>
                            </a>
                            <a href="{% url 'settings_app:template_create' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-plus text-orange-600 mr-3"></i>
                                <span>ایجاد تمپلیت جدید</span>
                            </a>
                            <a href="{% url 'settings_app:feature_flag_list' %}" class="flex items-center p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition">
                                <i class="fas fa-toggle-on text-yellow-600 mr-3"></i>
                                <span>فیچر فلگ‌ها</span>
                            </a>
                            <a href="{% url 'settings_app:feature_flag_create' %}" class="flex items-center p-3 bg-red-50 hover:bg-red-100 rounded-lg transition">
                                <i class="fas fa-plus text-red-600 mr-3"></i>
                                <span>ایجاد فیچر فلگ</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 🧮 Computation Engine -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="computationHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 role="button" type="button" data-target="#computationCollapse" aria-expanded="false" aria-controls="computationCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-calculator text-2xl text-indigo-600 mr-3"></i>
                            <span>موتور محاسبات</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="computationChevron"></i>
                    </button>
                </h3>
                <div id="computationCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="computationHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'computation_engine:template_list' %}" class="flex items-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition">
                                <i class="fas fa-list text-indigo-600 mr-3"></i>
                                <span>قالب‌های محاسبه</span>
                            </a>
                            <a href="{% url 'computation_engine:template_create' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-plus text-green-600 mr-3"></i>
                                <span>ایجاد قالب محاسبه</span>
                            </a>
                            <a href="{% url 'computation_engine:session_list' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-clock text-blue-600 mr-3"></i>
                                <span>جلسات محاسبه</span>
                            </a>
                            <a href="{% url 'computation_engine:result_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-chart-bar text-purple-600 mr-3"></i>
                                <span>نتایج محاسبه</span>
                            </a>
                            <a href="{% url 'computation_engine:metrics_list' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-chart-line text-orange-600 mr-3"></i>
                                <span>متریک‌های محاسبه</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 👥 Users Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="usersHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-teal-500 role="button" type="button" data-target="#usersCollapse" aria-expanded="false" aria-controls="usersCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-users text-2xl text-teal-600 mr-3"></i>
                            <span>مدیریت کاربران</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="usersChevron"></i>
                    </button>
                </h3>
                <div id="usersCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="usersHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'users:user_list' %}" class="flex items-center p-3 bg-teal-50 hover:bg-teal-100 rounded-lg transition">
                                <i class="fas fa-list text-teal-600 mr-3"></i>
                                <span>فهرست کاربران</span>
                            </a>
                            <a href="{% url 'users:user_create' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-plus text-green-600 mr-3"></i>
                                <span>ایجاد کاربر جدید</span>
                            </a>
                            <a href="{% url 'users:dashboard' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-tachometer-alt text-blue-600 mr-3"></i>
                                <span>داشبورد کاربری</span>
                            </a>
                            <a href="{% url 'users:advanced_dashboard' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-cogs text-purple-600 mr-3"></i>
                                <span>داشبورد پیشرفته</span>
                            </a>
                            <a href="{% url 'users:profile' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-user text-orange-600 mr-3"></i>
                                <span>پروفایل کاربری</span>
                            </a>
                            <a href="{% url 'users:advanced_profile' %}" class="flex items-center p-3 bg-red-50 hover:bg-red-100 rounded-lg transition">
                                <i class="fas fa-user-cog text-red-600 mr-3"></i>
                                <span>پروفایل پیشرفته</span>
                            </a>
                            <a href="{% url 'users:preferences' %}" class="flex items-center p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition">
                                <i class="fas fa-sliders-h text-yellow-600 mr-3"></i>
                                <span>تنظیمات کاربری</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 🔐 Advanced Accounts Management -->
            <div class="accordion-item border rounded-lg">
                <h3 class="accordion-header" id="accountsHeading">
                    <button class="accordion-button flex items-center justify-between w-full p-4 text-right font-medium text-gray-900 bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-pink-500 role="button" type="button" data-target="#accountsCollapse" aria-expanded="false" aria-controls="accountsCollapse">
                        <div class="flex items-center">
                            <i class="fas fa-shield-alt text-2xl text-pink-600 mr-3"></i>
                            <span>مدیریت پیشرفته حساب‌ها</span>
                        </div>
                        <i class="fas fa-chevron-down transition-transform" id="accountsChevron"></i>
                    </button>
                </h3>
                <div id="accountsCollapse" class="accordion-collapse max-h-0 overflow-hidden transition-all duration-300" aria-labelledby="accountsHeading">
                    <div class="accordion-body p-4 bg-white">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="{% url 'accounts:admin_dashboard' %}" class="flex items-center p-3 bg-pink-50 hover:bg-pink-100 rounded-lg transition">
                                <i class="fas fa-tachometer-alt text-pink-600 mr-3"></i>
                                <span>داشبورد مدیریت</span>
                            </a>
                            <a href="{% url 'accounts:user_list' %}" class="flex items-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition">
                                <i class="fas fa-users-cog text-blue-600 mr-3"></i>
                                <span>مدیریت کاربران پیشرفته</span>
                            </a>
                            <a href="{% url 'accounts:role_list' %}" class="flex items-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition">
                                <i class="fas fa-user-tag text-purple-600 mr-3"></i>
                                <span>مدیریت نقش‌ها</span>
                            </a>
                            <a href="{% url 'accounts:group_list' %}" class="flex items-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition">
                                <i class="fas fa-users text-green-600 mr-3"></i>
                                <span>مدیریت گروه‌ها</span>
                            </a>
                            <a href="{% url 'accounts:active_user_list' %}" class="flex items-center p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition">
                                <i class="fas fa-user-clock text-orange-600 mr-3"></i>
                                <span>کاربران فعال</span>
                            </a>
                            <a href="{% url 'accounts:audit_log_list' %}" class="flex items-center p-3 bg-red-50 hover:bg-red-100 rounded-lg transition">
                                <i class="fas fa-clipboard-list text-red-600 mr-3"></i>
                                <span>لاگ‌های سیستم</span>
                            </a>
                            <a href="{% url 'accounts:manage_timelock' %}" class="flex items-center p-3 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition">
                                <i class="fas fa-lock text-yellow-600 mr-3"></i>
                                <span>قفل زمانی</span>
                            </a>
                            <a href="{% url 'accounts:profile' %}" class="flex items-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition">
                                <i class="fas fa-user-circle text-indigo-600 mr-3"></i>
                                <span>پروفایل پیشرفته</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- Custom CSS for Accordion (Improved) -->
<style>
.accordion-button {
    background-color: #f8fafc;
    border: none;
    padding: 1rem;
    font-weight: 500;
    color: #374151;
    transition: all 0.3s ease;
    width: 100%;
}

.accordion-button:hover {
    background-color: #e5e7eb;
}

.accordion-button[aria-expanded="true"] {
    background-color: #dbeafe;
    color: #1e40af;
}

.accordion-button:focus {
    box-shadow: 0 0 0 0.25rem rgba(59, 130, 246, 0.25);
    border-color: #3b82f6;
}

.accordion-collapse {
    overflow: hidden;
    transition: max-height 0.3s ease-out;
}

.accordion-collapse[aria-expanded="true"] {
    max-height: 500px;
}

.fa-chevron-down {
    transition: transform 0.3s ease;
}

.accordion-button[aria-expanded="true"] .fa-chevron-down {
    transform: rotate(180deg);
}

.accordion-item {
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    margin-bottom: 0.5rem;
    overflow: hidden;
}

.accordion-item:last-child {
    margin-bottom: 0;
}
</style>

<!-- Custom JavaScript for Accordion (Pure & Fixed) -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const accordionButtons = document.querySelectorAll('.accordion-button');
    
    accordionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const targetId = this.getAttribute('data-target');
            const targetCollapse = document.querySelector(targetId);
            const chevron = this.querySelector('.fa-chevron-down');
            
            if (!targetCollapse) return;
            
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            
            // Close all other accordions
            accordionButtons.forEach(otherButton => {
                if (otherButton !== this) {
                    const otherTargetId = otherButton.getAttribute('data-target');
                    const otherTarget = document.querySelector(otherTargetId);
                    if (otherTarget) {
                        otherButton.setAttribute('aria-expanded', 'false');
                        otherTarget.style.maxHeight = '0';
                    }
                }
            });
            
            // Toggle current
            if (isExpanded) {
                this.setAttribute('aria-expanded', 'false');
                targetCollapse.style.maxHeight = '0';
                if (chevron) chevron.style.transform = 'rotate(0deg)';
            } else {
                this.setAttribute('aria-expanded', 'true');
                targetCollapse.style.maxHeight = targetCollapse.scrollHeight + 'px';
                if (chevron) chevron.style.transform = 'rotate(180deg)';
            }
        });
    });
    
    // Initialize first accordion as open
    const firstButton = document.querySelector('#productsHeading .accordion-button');
    const firstCollapse = document.querySelector('#productsCollapse');
    const firstChevron = document.querySelector('#productsChevron');
    
    if (firstButton && firstCollapse) {
        firstButton.setAttribute('aria-expanded', 'true');
        firstCollapse.style.maxHeight = firstCollapse.scrollHeight + 'px';
        if (firstChevron) firstChevron.style.transform = 'rotate(180deg)';
    }
});
</script>
{% endblock %}